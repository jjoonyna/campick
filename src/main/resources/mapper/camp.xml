<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.choongang.campick.mapper.CampDAO">



	<!-- 캠핑장 기본목록 및 검색목록 개수 -->
	<select id="count" parameterType="camp" resultType="int">
		select count(*) from camp
		<where>
			<if
				test="search != null and induty == null and doNm == null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%'
			</if>
			<if
				test="search != null and induty == null and doNm != null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and doNm = #{doNm}
			</if>
			<if
				test="search != null and induty == null and doNm != null and sigunguNm !=null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and doNm = #{doNm} and sigunguNm =#{sigunguNm}
			</if>
			<if
				test="search != null and induty != null and doNm == null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty}
			</if>
			<if
				test="search != null and induty != null and doNm != null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty} and doNm = #{doNm}
			</if>
			<if
				test="search != null and induty != null and doNm != null and sigunguNm !=null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty} and doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>
			<if
				test="search == null and induty != null and doNm == null and sigunguNm ==null">
				induty = #{induty}
			</if>
			<if
				test="search == null and induty != null and doNm != null and sigunguNm ==null">
				induty = #{induty} and doNm = #{doNm}
			</if>
			<if
				test="search == null and induty != null and doNm != null and sigunguNm !=null">
				induty = #{induty} and doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>
			<if
				test="search == null and induty = null and doNm != null and sigunguNm ==null">
				doNm = #{doNm}
			</if>
			<if
				test="search == null and induty == null and doNm != null and sigunguNm !=null">
				doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>

		</where>

	</select>

	<!-- 캠핑장 기본 목록 및 검색목록 -->
	<select id="campList" parameterType="camp" resultType="camp">
		select * from camp
		<where>
			<if
				test="search != null and induty == null and doNm == null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%'
			</if>
			<if
				test="search != null and induty == null and doNm != null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and doNm = #{doNm}
			</if>
			<if
				test="search != null and induty == null and doNm != null and sigunguNm !=null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and doNm = #{doNm} and sigunguNm =#{sigunguNm}
			</if>
			<if
				test="search != null and induty != null and doNm == null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty}
			</if>
			<if
				test="search != null and induty != null and doNm != null and sigunguNm ==null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty} and doNm = #{doNm}
			</if>
			<if
				test="search != null and induty != null and doNm != null and sigunguNm !=null">
				lineIntro like '%'||#{search}||'%' or facltNm like '%'||#{search}||'%' and induty = #{induty} and doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>
			<if
				test="search == null and induty != null and doNm == null and sigunguNm ==null">
				induty = #{induty}
			</if>
			<if
				test="search == null and induty != null and doNm != null and sigunguNm ==null">
				induty = #{induty} and doNm = #{doNm}
			</if>
			<if
				test="search == null and induty != null and doNm != null and sigunguNm !=null">
				induty = #{induty} and doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>
			<if
				test="search == null and induty = null and doNm != null and sigunguNm ==null">
				doNm = #{doNm}
			</if>
			<if
				test="search == null and induty == null and doNm != null and sigunguNm !=null">
				doNm = #{doNm} and sigunguNm = #{sigunguNm}
			</if>

		</where>

		order by cmp_like desc limit #{start},10

	</select>







	<!-- 캠핑장 등록하기 -->
	<insert id="insertBizCmp" parameterType="camp">
		insert into camp(
			contentId,
			user_id,
			facltNm,
			lctCl,
			lineIntro,
			intro,
			featureNm,
			induty,
			doNm,
			sigunguNm,
			zipcode,
			addr1,
			mapX,
			mapY,
  			tel,
  			homepage,
  			gnrlSiteCo,
  			autoSiteCo,
  			glampSiteCo,
  			caravSiteCo,
			glampInnerFclty,
			caravInnerFclty,
			toiletCo,
			swrmCo,
			wtrplCo,
			brazierCl,
			sbrsCl,
			sbrsEtc,
			posblFcltyCl,
			extshrCo,
			themaEnvrnCl,
			animalCmgCl,
			firstImageUrl,
			cmp_pic,
			cmp_fav,
			cmp_like,
			cmp_maxpp,
			cmp_staydate,
			cmp_price,
			trlerAcmpnyAt,
			caravAcmpnyAt
		)values(
			#{contentId},
			#{user_id},
			#{facltNm},
			#{lctCl},
			#{lineIntro},
			#{intro},
			#{featureNm},
			#{induty},
			#{doNm},
			#{sigunguNm},
			#{zipcode},
			#{addr1},
			#{mapX},
			#{mapY},
  			#{tel},
  			#{homepage},
  			#{gnrlSiteCo},
  			#{autoSiteCo},
  			#{glampSiteCo},
  			#{caravSiteCo},
			#{glampInnerFclty},
			#{caravInnerFclty},
			#{toiletCo},
			#{swrmCo},
			#{wtrplCo},
			#{brazierCl},
			#{sbrsCl},
			#{sbrsEtc},
			#{posblFcltyCl},
			#{extshrCo},
			#{themaEnvrnCl},
			#{animalCmgCl},
			#{firstImageUrl},
			#{cmp_pic},
			#{cmp_fav},
			#{cmp_like},
			#{cmp_maxpp},
			#{cmp_staydate},
			#{cmp_price},
			#{trlerAcmpnyAt},
			#{caravAcmpnyAt}
		)
	</insert>
	
	<!-- 캠핑장 조회하기 -->
	<select id="selectBizCmp" parameterType="String" resultType="camp">
		select
				*
		from
				camp
		where
				contentId = #{contentId}
	</select>
 
	<!-- 캠핑장 등록 삭제 -->
	<update id="deleteBizCmp" parameterType="String">
		UPDATE camp
		SET
		cmp_kind = 'd'
		WHERE contentId = #{contentId}
	</update>
	
	
</mapper>